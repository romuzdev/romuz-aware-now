# Ø®Ø·Ø© Ø§Ù„ØªÙˆØ³Ø¹ â€” Platform Expansion Plan v1.0
## ğŸ“˜ Ø®Ø·Ø© ØªÙ†ÙÙŠØ°ÙŠØ© Ø¯Ù‚ÙŠÙ‚Ø© ÙˆÙ…ÙØµÙ„Ø© Ù„Ù„ØªØ­ÙˆÙ„ Ø¥Ù„Ù‰ Ù…Ù†ØµØ© Ù…ØªØ¹Ø¯Ø¯Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª

**Ø§Ù„Ù…Ø´Ø±ÙˆØ¹:** Romuz Cybersecurity Culture Platform  
**Ø§Ù„ØªØ§Ø±ÙŠØ®:** 2025-11-14  
**Ø§Ù„Ø­Ø§Ù„Ø©:** âœ… Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„ØªÙ†ÙÙŠØ°  
**Ø§Ù„Ù‡Ø¯Ù:** ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ Ù…Ù† ØªØ·Ø¨ÙŠÙ‚ GRC/Awareness Ø¥Ù„Ù‰ Ù…Ù†ØµØ© Ø£Ù… (Core Platform) ØªØ¯Ø¹Ù… ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø©  
**Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ©:** Ù…Ø·Ø§Ø¨Ù‚Ø© 100% Ù„Ù„Ù…Ø®Ø·Ø· Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠ Ø§Ù„Ù…Ø±Ø¬Ø¹ÙŠ

---

## ğŸ¯ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ©

ØªØªÙƒÙˆÙ† Ø§Ù„Ù…Ù†ØµØ© Ù…Ù† 3 Ø·Ø¨Ù‚Ø§Øª Ø±Ø¦ÙŠØ³ÙŠØ©:

### 1ï¸âƒ£ Core Platform Layer
> **Ø§Ù„Ø·Ø¨Ù‚Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©** - Ø®Ø¯Ù…Ø§Øª Ù…Ø´ØªØ±ÙƒØ© Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Core Platform                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Auth   â”‚   User   â”‚   RBAC   â”‚ Tenancy  â”‚  Shared  â”‚   Integr.â”‚
â”‚          â”‚   Mgmt   â”‚          â”‚          â”‚ Services â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚          â”‚          â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ (Shared Infrastructure)
```

### 2ï¸âƒ£ Application Modules Layer
> **Ø·Ø¨Ù‚Ø© Ø§Ù„ÙˆØ­Ø¯Ø§Øª** - ÙˆØ­Ø¯Ø§Øª Ø¹Ù…Ù„ Ù‚Ø§Ø¨Ù„Ø© Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Application Modules                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚Documents â”‚ Reports  â”‚  Alerts  â”‚ Content  â”‚       KPIs        â”‚
â”‚          â”‚          â”‚          â”‚   Hub    â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3ï¸âƒ£ Applications Layer
> **Ø·Ø¨Ù‚Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª** - ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ù…Ø³ØªÙ‚Ù„Ø© ØªØ³ØªØ®Ø¯Ù… Core + Modules

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Applications                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚Awareness â”‚ Phishing â”‚   LMS    â”‚   GRC    â”‚  Other Apps       â”‚
â”‚          â”‚Simulator â”‚          â”‚          â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ Ù…Ù„Ø®Øµ ØªÙ†ÙÙŠØ°ÙŠ Executive Summary

### Ø§Ù„Ø±Ø¤ÙŠØ© Vision
ØªØ­ÙˆÙŠÙ„ Ù†Ø¸Ø§Ù… Romuz Ù…Ù† ØªØ·Ø¨ÙŠÙ‚ ÙˆØ§Ø­Ø¯ Ù„Ù„ØªÙˆØ¹ÙŠØ© ÙˆØ§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø¥Ù„Ù‰ **Ù…Ù†ØµØ© Ù…ÙˆØ­Ø¯Ø© Ù…ØªØ¹Ø¯Ø¯Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª** (Multi-Application Platform) ØªØ¯Ø¹Ù…:
- ğŸ“š Ù…Ù†ØµØ© Ø§Ù„ØªÙˆØ¹ÙŠØ© Ø§Ù„Ø£Ù…Ù†ÙŠØ© (Awareness)
- ğŸ“ Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„Ù… (LMS)
- ğŸ£ Ù…Ø­Ø§ÙƒÙŠ Ø§Ù„ØªØµÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ (Phishing Simulator)
- ğŸ›¡ï¸ Ù…Ù†ØµØ© Ø§Ù„Ø­ÙˆÙƒÙ…Ø© ÙˆØ§Ù„Ø§Ù…ØªØ«Ø§Ù„ (GRC)
- ğŸ¯ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø«Ù‚Ø§ÙØ© Ø§Ù„Ø£Ù…Ù†ÙŠØ© (Culture Management)
- ğŸ¤– Ù…Ø³ØªØ´Ø§Ø± Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ (AI Advisory)
- â• ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ© Ø£Ø®Ø±Ù‰

### Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Current State Assessment

#### âœ… **Ù…Ø§ ØªÙ… Ø¥Ù†Ø¬Ø§Ø²Ù‡ (85% Ù…Ù† Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©)**

1. **Multi-Tenancy + RLS (100%)** âœ…
   - Ø¹Ø²Ù„ ØªØ§Ù… Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±ÙŠÙ† (Tenants)
   - Row-Level Security ÙƒØ§Ù…Ù„Ø©
   - Ø¬Ø¯Ø§ÙˆÙ„: `tenants`, `user_tenants`, `tenant_settings`

2. **Authentication & Identity (100%)** âœ…
   - ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ù…ÙˆØ­Ø¯
   - JWT + Session Management
   - MFA support
   - Ø¬Ø¯Ø§ÙˆÙ„: `profiles`, `user_roles`

3. **RBAC Core (80%)** âš ï¸
   - Ù†Ø¸Ø§Ù… ØµÙ„Ø§Ø­ÙŠØ§Øª Ø£Ø³Ø§Ø³ÙŠ Ù…ÙˆØ¬ÙˆØ¯
   - ÙŠØ­ØªØ§Ø¬ ØªÙØµÙŠÙ„ Ø£ÙƒØ«Ø± (resource-based permissions)
   - Ø¬Ø¯Ø§ÙˆÙ„: `roles`, `user_roles`
   - Ù…ÙƒØªØ¨Ø©: `src/lib/rbac/index.tsx`, `src/hooks/rbac/useRBAC.ts`

4. **Shared Services (70%)** âš ï¸
   - **Documents Engine** (90%): `documents`, `document_versions`, `attachments` âœ…
   - **Reports** (80%): Ù…ØªÙˆÙØ±Ø© Ø¬Ø²Ø¦ÙŠØ§Ù‹ âœ…
   - **Alerts** (85%): `alert_policies`, `alert_channels`, `alert_events` âœ…
   - **Audit Log** (100%): `audit_log` âœ…
   - **Integrations** (60%): Ø¨Ù†ÙŠØ© Ø£Ø³Ø§Ø³ÙŠØ© Ù…ÙˆØ¬ÙˆØ¯Ø© âš ï¸

5. **Application Context (100%)** âœ…
   - `AppContextProvider` Ø¬Ø§Ù‡Ø² ØªÙ…Ø§Ù…Ø§Ù‹
   - ÙŠÙˆÙØ±: `tenantId`, `userId`, `userRoles`, `profile`

6. **UI Components Library (95%)** âœ…
   - Shadcn/UI ÙƒØ§Ù…Ù„Ø©
   - Ù…ÙƒÙˆÙ†Ø§Øª Ù…Ø´ØªØ±ÙƒØ© Ø¬Ø§Ù‡Ø²Ø©
   - Ù†Ø¸Ø§Ù… ØªØµÙ…ÙŠÙ… Ù…ÙˆØ­Ø¯ (Design System)
   - Ø¯Ø¹Ù… RTL + i18n

#### âš ï¸ **Ù…Ø§ ÙŠØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ† (Ø§Ù„ÙØ¬ÙˆØ§Øª Ø§Ù„Ø­Ø±Ø¬Ø©)**

1. **Code Structure (40%)** âŒ
   - Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙØµÙ„ ÙˆØ§Ø¶Ø­ Ø¨ÙŠÙ† Core Ùˆ Apps
   - ÙƒÙ„ Ø´ÙŠØ¡ Ù…Ø®Ù„ÙˆØ· ÙÙŠ `src/`
   - ÙŠØ­ØªØ§Ø¬ Ø¥Ø¹Ø§Ø¯Ø© Ù‡ÙŠÙƒÙ„Ø© Ø¥Ù„Ù‰:
     - `src/core/` â†’ Ø®Ø¯Ù…Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ©
     - `src/modules/` â†’ ÙˆØ­Ø¯Ø§Øª Ù…Ø´ØªØ±ÙƒØ©
     - `src/apps/` â†’ ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ù…Ù†ÙØµÙ„Ø©

2. **Permission System (50%)** âŒ
   - Ù†Ø¸Ø§Ù… RBAC Ø¨Ø³ÙŠØ· Ø¬Ø¯Ø§Ù‹ (admin, user, viewer)
   - Ù„Ø§ ÙŠØ¯Ø¹Ù… ØµÙ„Ø§Ø­ÙŠØ§Øª ØªÙØµÙŠÙ„ÙŠØ© Ù…Ø«Ù„:
     - `awareness.campaign.create`
     - `lms.course.enroll`
     - `phishing.scenario.launch`
   - ÙŠØ­ØªØ§Ø¬: `role_permissions` table + `usePermissions` hook

3. **App Registry (0%)** âŒ
   - Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Ø¸Ø§Ù… Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª
   - Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙƒÙˆÙŠÙ† Ù…Ø±ÙƒØ²ÙŠ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©
   - ÙŠØ­ØªØ§Ø¬: `src/config/appRegistry.ts`

4. **Dynamic Sidebar (30%)** âŒ
   - Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© Ø«Ø§Ø¨ØªØ© (hard-coded)
   - Ù„Ø§ ØªØªØºÙŠØ± Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
   - Ù„Ø§ ØªØ¯Ø¹Ù… Ø¥Ø¶Ø§ÙØ© ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹

5. **Content Hub (M4) - Implementation Gap (25%)** âš ï¸
   - **Ù…ÙˆØ¬ÙˆØ¯ Ù…ÙÙ‡ÙˆÙ…ÙŠÙ‹Ø§ 100%** ÙÙŠ Ø§Ù„ØªÙˆØ«ÙŠÙ‚ âœ…
   - **Ù…ÙˆØ¬ÙˆØ¯ ØªÙ†ÙÙŠØ°ÙŠØ§Ù‹ 25%** ÙÙ‚Ø·:
     - `campaign_modules` Ù…ÙˆØ¬ÙˆØ¯ âœ…
     - `src/integrations/supabase/modules.ts` Ù…ÙˆØ¬ÙˆØ¯ âœ…
     - Ù„ÙƒÙ† Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„ÙƒØ§Ù…Ù„Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©:
       - `contents` âŒ
       - `content_assets` âŒ
       - `quiz_templates` âŒ
       - `quiz_template_questions` âŒ
       - `micro_journeys` âŒ
       - `evidence_packs` âŒ
       - `content_audit_log` âŒ

6. **Event System (0%)** âŒ
   - Ù„Ø§ ÙŠÙˆØ¬Ø¯ Event Bus Ù„Ù„ØªÙˆØ§ØµÙ„ Ø¨ÙŠÙ† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª
   - Ø§Ù„Ø±Ø¨Ø· Ø§Ù„Ù…Ø¨Ø§Ø´Ø± (Tight Coupling) Ø¨ÙŠÙ† Ø§Ù„ÙˆØ­Ø¯Ø§Øª
   - ÙŠØ­ØªØ§Ø¬: `src/core/events/AppEventBus.ts`

7. **Feature Flags per App (40%)** âš ï¸
   - Ø¬Ø¯ÙˆÙ„ `feature_flags` Ù…ÙˆØ¬ÙˆØ¯
   - Ù„ÙƒÙ† Ù„Ø§ ÙŠÙˆØ¬Ø¯ integration ÙƒØ§Ù…Ù„ Ù…Ø¹ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª

---

## ğŸ¯ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Strategic Goals

### Ù‡Ø¯Ù Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1 (Foundation)
> **ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¥Ù„Ù‰ Ù…Ù†ØµØ© Ø£Ø³Ø§Ø³ÙŠØ© Ø¬Ø§Ù‡Ø²Ø© Ù„Ø¥Ø¶Ø§ÙØ© ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© Ø®Ù„Ø§Ù„ Ø³Ø§Ø¹Ø§Øª Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø£Ø³Ø§Ø¨ÙŠØ¹**

**Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª:**
1. Ø¨Ù†ÙŠØ© ÙƒÙˆØ¯ Ù…Ø¹Ù…Ø§Ø±ÙŠØ© ÙˆØ§Ø¶Ø­Ø© (core / modules / apps)
2. Ù†Ø¸Ø§Ù… ØµÙ„Ø§Ø­ÙŠØ§Øª ØªÙØµÙŠÙ„ÙŠ Ù…Ø±Ù†
3. App Registry Ù…Ø±ÙƒØ²ÙŠ
4. Ù‚Ø§Ø¦Ù…Ø© Ø¬Ø§Ù†Ø¨ÙŠØ© Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©
5. Content Hub ÙƒØ§Ù…Ù„ Ø§Ù„ØªÙ†ÙÙŠØ°

### Ù‡Ø¯Ù Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2 (Expansion)
> **Ø¥Ø·Ù„Ø§Ù‚ 3 ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø±Ø¦ÙŠØ³ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØµØ©: AwarenessØŒ LMSØŒ Phishing Simulator**

### Ù‡Ø¯Ù Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3 (Optimization)
> **ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙˆØ¥Ø¶Ø§ÙØ© Event System ÙˆØªÙˆØ³ÙŠØ¹ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ**

---

## ğŸ“Š Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØªÙØµÙŠÙ„ÙŠ Ø§Ù„Ø¯Ù‚ÙŠÙ‚ Detailed Assessment

### 1ï¸âƒ£ Core Platform Layer (85% Ø¬Ø§Ù‡Ø²)

| Component | Status | Progress | Notes |
|-----------|--------|----------|-------|
| Multi-Tenancy | âœ… Complete | 100% | Full isolation, RLS policies perfect |
| Authentication | âœ… Complete | 100% | JWT, Sessions, MFA ready |
| User Management | âœ… Complete | 100% | `profiles`, `user_roles` |
| Basic RBAC | âš ï¸ Needs Work | 80% | Works but needs resource-based permissions |
| Tenant Settings | âœ… Complete | 100% | `admin_settings`, `tenant_settings` |
| Audit Log | âœ… Complete | 100% | Full audit trail |
| App Context | âœ… Complete | 100% | `AppContextProvider` ready |

**Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: 85%** â€” Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…ØŒ ÙŠØ­ØªØ§Ø¬ RBAC enhancement ÙÙ‚Ø·

---

### 2ï¸âƒ£ Shared Services Layer (71% Ø¬Ø§Ù‡Ø²)

| Service | Status | Progress | Tables | Code Integration |
|---------|--------|----------|--------|------------------|
| Documents Engine | âœ… Good | 90% | `documents`, `document_versions`, `attachments` | `src/services/documentService.ts` âœ… |
| Attachments | âœ… Good | 90% | `attachments` | `src/services/attachmentService.ts` âœ… |
| Reports | âš ï¸ Partial | 80% | Multiple report tables | Needs consolidation |
| Alerts | âœ… Good | 85% | `alert_policies`, `alert_channels`, `alert_events` | Working |
| Integrations | âš ï¸ Basic | 60% | Integration tables exist | Needs standardization |
| Content Hub (M4) | âŒ Incomplete | 25% | Only `campaign_modules` | **Critical Gap** |

**Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: 71%** â€” Ø®Ø¯Ù…Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ© Ù…ÙˆØ¬ÙˆØ¯Ø©ØŒ Content Hub ÙŠØ­ØªØ§Ø¬ Ø¹Ù…Ù„

---

### 3ï¸âƒ£ Application Modules Layer (58% Ø¬Ø§Ù‡Ø²)

| Module | Status | Progress | Implementation | Gap Analysis |
|--------|--------|----------|----------------|--------------|
| **M1 - Tenant & Identity** | âœ… | 100% | Complete | None |
| **M2 - Campaigns** | âœ… | 95% | `awareness_campaigns`, `campaign_modules`, Full UI | Excellent |
| **M3 - Culture Index** | âœ… | 90% | KPIs, Scores, Validations | Good |
| **M4 - Content Hub** | âŒ | 25% | Only `campaign_modules` | **75% missing** |
| **M5 - Gamification** | âš ï¸ | 60% | Tables exist, no UI | Needs UI work |
| **M6 - Integrations Core** | âš ï¸ | 60% | Basic structure | Needs expansion |
| **M7 - Admin Config** | âœ… | 95% | `admin_settings` complete | Excellent |
| **M8 - Escalation/Alerts** | âœ… | 85% | Full alert system | Good |
| **M9 - Phishing** | âš ï¸ | 40% | Tables exist, no full flow | Needs implementation |
| **M10 - Reports/Evidence** | âš ï¸ | 75% | Partial implementation | Needs consolidation |
| **M11-M25** | ğŸ“‹ | 0-40% | Documented, not implemented | Future work |

**Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: 58%** â€” M1-M3 Ù…Ù…ØªØ§Ø²Ø©ØŒ M4 ÙØ¬ÙˆØ© Ø­Ø±Ø¬Ø©ØŒ M5-M10 ØªØ­ØªØ§Ø¬ Ø¹Ù…Ù„

---

### 4ï¸âƒ£ Applications Layer (31% Ø¬Ø§Ù‡Ø²)

| Application | Conceptual | Implementation | UI | Integration | Overall |
|-------------|------------|----------------|----|--------------| --------|
| **Awareness Platform** | âœ… 100% | âš ï¸ 70% | âœ… 85% | âš ï¸ 60% | **79%** |
| **LMS** | âœ… 100% | âŒ 10% | âŒ 5% | âŒ 0% | **29%** |
| **Phishing Simulator** | âœ… 100% | âš ï¸ 40% | âŒ 20% | âŒ 10% | **43%** |
| **GRC Platform** | âœ… 100% | âš ï¸ 50% | âš ï¸ 40% | âš ï¸ 30% | **55%** |
| **Culture Management** | âœ… 100% | âš ï¸ 60% | âš ï¸ 50% | âš ï¸ 40% | **63%** |

**Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: 31%** â€” Ù…ÙØ§Ù‡ÙŠÙ…ÙŠØ§Ù‹ Ø¬Ø§Ù‡Ø² 100%ØŒ ØªÙ†ÙÙŠØ°ÙŠØ§Ù‹ ÙŠØ­ØªØ§Ø¬ Ø¹Ù…Ù„ ÙƒØ¨ÙŠØ±

---

### 5ï¸âƒ£ Architecture Quality (62% Ø¬Ø§Ù‡Ø²)

| Aspect | Status | Progress | Gap |
|--------|--------|----------|-----|
| Code Structure | âŒ Poor | 40% | No separation (core/modules/apps) |
| Permission System | âš ï¸ Basic | 50% | Need resource-based permissions |
| App Registry | âŒ Missing | 0% | No centralized app config |
| Dynamic Sidebar | âš ï¸ Static | 30% | Hard-coded menu items |
| Event System | âŒ Missing | 0% | Tight coupling between modules |
| Feature Flags | âš ï¸ Partial | 40% | Table exists, not integrated |
| Services Layer | âœ… Good | 80% | Good start, needs expansion |

**Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: 62%** â€” Ø¨Ù†ÙŠØ© Ø¬ÙŠØ¯Ø© Ù„ÙƒÙ† ØªØ­ØªØ§Ø¬ Refactoring

---

## ğŸš€ Ø®Ø·Ø© Ø§Ù„ØªÙ†ÙÙŠØ° Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ© Detailed Implementation Plan

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1: ØªØ£Ø³ÙŠØ³ Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© (Foundation) â€” 24 Ø³Ø§Ø¹Ø© Ø¹Ù…Ù„

#### **Part 1.1: Code Restructuring (4 Ø³Ø§Ø¹Ø§Øª)** ğŸ—ï¸
**Ø§Ù„Ù‡Ø¯Ù:** Ø¥Ø¹Ø§Ø¯Ø© ØªÙ†Ø¸ÙŠÙ… Ø§Ù„ÙƒÙˆØ¯ Ù„ÙØµÙ„ Core Ø¹Ù† Modules Ø¹Ù† Apps

**Ø§Ù„Ø®Ø·ÙˆØ§Øª:**
1. Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©:
```
src/
â”œâ”€â”€ core/                    # â­ NEW - Core Platform Services
â”‚   â”œâ”€â”€ auth/               # Authentication utilities
â”‚   â”œâ”€â”€ rbac/               # Enhanced RBAC system
â”‚   â”œâ”€â”€ tenancy/            # Multi-tenant helpers
â”‚   â”œâ”€â”€ events/             # Event Bus (Phase 2)
â”‚   â””â”€â”€ services/           # Shared services (documents, alerts, etc.)
â”œâ”€â”€ modules/                 # â­ NEW - Reusable Business Modules
â”‚   â”œâ”€â”€ campaigns/          # M2 - Campaign management
â”‚   â”œâ”€â”€ content-hub/        # M4 - Content Hub
â”‚   â”œâ”€â”€ culture-index/      # M3 - Culture KPIs
â”‚   â”œâ”€â”€ documents/          # M10 - Documents & Reports
â”‚   â”œâ”€â”€ alerts/             # M8 - Alert system
â”‚   â””â”€â”€ integrations/       # M6 - Integrations
â”œâ”€â”€ apps/                    # â­ NEW - Standalone Applications
â”‚   â”œâ”€â”€ awareness/          # Awareness Platform
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â””â”€â”€ routes.tsx
â”‚   â”œâ”€â”€ lms/                # LMS (Future)
â”‚   â”œâ”€â”€ phishing/           # Phishing Simulator (Future)
â”‚   â””â”€â”€ grc/                # GRC Platform (Future)
â”œâ”€â”€ components/              # Shared UI Components (keep)
â”œâ”€â”€ layouts/                 # Layouts (keep)
â”œâ”€â”€ lib/                     # Utilities (keep)
â””â”€â”€ types/                   # TypeScript types (keep)
```

2. Ù†Ù‚Ù„ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©:
   - Ù†Ù‚Ù„ `src/lib/rbac/` â†’ `src/core/rbac/`
   - Ù†Ù‚Ù„ `src/services/` â†’ `src/core/services/`
   - Ù†Ù‚Ù„ `src/pages/admin/campaigns/` â†’ `src/apps/awareness/pages/campaigns/`
   - Ù†Ù‚Ù„ `src/integrations/supabase/campaigns.ts` â†’ `src/modules/campaigns/integration.ts`

3. Ø¥Ù†Ø´Ø§Ø¡ barrel exports Ù„ÙƒÙ„ Ù…Ø¬Ù„Ø¯:
   - `src/core/index.ts`
   - `src/modules/index.ts`
   - `src/apps/index.ts`

**Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª:**
- âœ… Ø¨Ù†ÙŠØ© ÙˆØ§Ø¶Ø­Ø© Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙˆØ³Ø¹
- âœ… Ø³Ù‡ÙˆÙ„Ø© Ø¥Ø¶Ø§ÙØ© ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©
- âœ… ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù€ import paths complexity

**Ø§Ù„Ù…Ø®Ø§Ø·Ø±:** Ù‚Ø¯ ØªØ­ØªØ§Ø¬ ØªØ¹Ø¯ÙŠÙ„ imports ÙÙŠ ~100 Ù…Ù„Ù

---

#### **Part 1.2: App Registry System (3 Ø³Ø§Ø¹Ø§Øª)** ğŸ“‹

**Ø§Ù„Ù‡Ø¯Ù:** Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø¸Ø§Ù… Ù…Ø±ÙƒØ²ÙŠ Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª ÙˆØ¥Ø¯Ø§Ø±ØªÙ‡Ø§

**Ø§Ù„Ø®Ø·ÙˆØ§Øª:**

1. Ø¥Ù†Ø´Ø§Ø¡ `src/core/config/appRegistry.ts`:
```typescript
export interface AppModule {
  id: string;                          // 'awareness', 'lms', 'phishing'
  name: string;                        // Display name
  nameAr: string;                      // Arabic name
  description: string;
  icon: LucideIcon;
  route: string;                       // Base route '/app/awareness'
  requiredPermission: string;          // 'app.awareness.access'
  color: string;                       // Brand color
  status: 'active' | 'beta' | 'coming_soon';
  features: AppFeature[];
  dependencies?: string[];             // Other app IDs this depends on
}

export interface AppFeature {
  id: string;
  name: string;
  route: string;
  icon: LucideIcon;
  requiredPermission: string;
}

export const APP_MODULES: AppModule[] = [
  {
    id: 'awareness',
    name: 'Awareness',
    nameAr: 'Ø§Ù„ØªÙˆØ¹ÙŠØ© Ø§Ù„Ø£Ù…Ù†ÙŠØ©',
    description: 'Security Awareness Campaigns',
    icon: Target,
    route: '/app/awareness',
    requiredPermission: 'app.awareness.access',
    color: 'hsl(var(--primary))',
    status: 'active',
    features: [
      {
        id: 'campaigns',
        name: 'Campaigns',
        route: '/app/awareness/campaigns',
        icon: Megaphone,
        requiredPermission: 'awareness.campaign.view'
      },
      // ... more features
    ]
  },
  {
    id: 'lms',
    name: 'LMS',
    nameAr: 'Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ¯Ø±ÙŠØ¨',
    description: 'Learning Management System',
    icon: GraduationCap,
    route: '/app/lms',
    requiredPermission: 'app.lms.access',
    color: 'hsl(210, 100%, 50%)',
    status: 'coming_soon',
    features: []
  },
  // ... more apps
];
```

2. Ø¥Ù†Ø´Ø§Ø¡ `src/core/hooks/useAppModules.ts`:
```typescript
export function useAppModules() {
  const { hasPermission } = usePermissions();
  
  return useMemo(() => {
    return APP_MODULES
      .filter(app => hasPermission(app.requiredPermission))
      .filter(app => app.status === 'active' || app.status === 'beta');
  }, [hasPermission]);
}
```

3. Ø¥Ù†Ø´Ø§Ø¡ `src/core/hooks/useAppFeatures.ts`:
```typescript
export function useAppFeatures(appId: string) {
  const { hasPermission } = usePermissions();
  const app = APP_MODULES.find(a => a.id === appId);
  
  return useMemo(() => {
    if (!app) return [];
    return app.features.filter(f => hasPermission(f.requiredPermission));
  }, [app, hasPermission]);
}
```

**Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª:**
- âœ… ØªØ³Ø¬ÙŠÙ„ Ù…Ø±ÙƒØ²ÙŠ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª
- âœ… Ø³Ù‡ÙˆÙ„Ø© Ø¥Ø¶Ø§ÙØ©/Ø¥Ø²Ø§Ù„Ø© ØªØ·Ø¨ÙŠÙ‚Ø§Øª
- âœ… Ø¯Ø¹Ù… Feature Flags Ùˆ Permissions

---

#### **Part 1.3: Enhanced Permission System (6 Ø³Ø§Ø¹Ø§Øª)** ğŸ”

**Ø§Ù„Ù‡Ø¯Ù:** ØªØ­ÙˆÙŠÙ„ RBAC Ù…Ù† simple roles Ø¥Ù„Ù‰ resource-based permissions

**Ø§Ù„Ø®Ø·ÙˆØ§Øª:**

1. **Migration - Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª**:
```sql
-- Create role_permissions table
CREATE TABLE IF NOT EXISTS public.role_permissions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  tenant_id UUID REFERENCES public.tenants(id) ON DELETE CASCADE,
  role_code TEXT NOT NULL, -- 'admin', 'manager', 'user', 'viewer'
  
  -- Permission format: "resource.action"
  -- Examples: 'awareness.campaign.create', 'lms.course.view'
  permission_code TEXT NOT NULL,
  
  -- Metadata
  created_at TIMESTAMPTZ DEFAULT now(),
  created_by UUID REFERENCES auth.users(id),
  
  -- Constraints
  UNIQUE(tenant_id, role_code, permission_code)
);

-- RLS Policies
ALTER TABLE public.role_permissions ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can view permissions in their tenant"
  ON public.role_permissions FOR SELECT
  USING (tenant_id = get_user_tenant_id(auth.uid()));

CREATE POLICY "Admins can manage permissions"
  ON public.role_permissions FOR ALL
  USING (
    tenant_id = get_user_tenant_id(auth.uid()) 
    AND has_role(auth.uid(), 'admin')
  );

-- Seed default permissions
INSERT INTO public.role_permissions (tenant_id, role_code, permission_code)
SELECT 
  t.id,
  unnest(ARRAY['admin', 'manager', 'user', 'viewer']),
  unnest(ARRAY[
    -- App access
    'app.awareness.access',
    'app.lms.access',
    'app.phishing.access',
    'app.grc.access',
    
    -- Awareness permissions
    'awareness.campaign.view',
    'awareness.campaign.create',
    'awareness.campaign.edit',
    'awareness.campaign.delete',
    'awareness.campaign.launch',
    'awareness.participant.view',
    'awareness.participant.manage',
    
    -- Content Hub permissions
    'content.item.view',
    'content.item.create',
    'content.item.edit',
    'content.item.delete',
    'content.item.publish',
    'content.quiz.create',
    'content.evidence.export',
    
    -- LMS permissions (future)
    'lms.course.view',
    'lms.course.create',
    'lms.course.enroll',
    'lms.assignment.submit',
    
    -- Phishing permissions (future)
    'phishing.campaign.view',
    'phishing.campaign.launch',
    'phishing.template.create',
    
    -- System permissions
    'system.settings.view',
    'system.settings.edit',
    'system.audit.view',
    'system.users.manage'
  ])
FROM tenants t
WHERE NOT EXISTS (
  SELECT 1 FROM public.role_permissions WHERE tenant_id = t.id
);
```

2. **Hook - Ø¥Ù†Ø´Ø§Ø¡ `usePermissions` hook**:
```typescript
// src/core/hooks/usePermissions.ts
export function usePermissions() {
  const { tenantId, userRoles } = useAppContext();
  
  const { data: permissions = [] } = useQuery({
    queryKey: ['permissions', tenantId, userRoles],
    queryFn: async () => {
      const { data } = await supabase
        .from('role_permissions')
        .select('permission_code')
        .in('role_code', userRoles);
      
      return data?.map(p => p.permission_code) || [];
    },
    enabled: !!tenantId && userRoles.length > 0,
    staleTime: 5 * 60 * 1000, // Cache for 5 minutes
  });
  
  const hasPermission = useCallback((perm: string) => {
    // Super admin has all permissions
    if (userRoles.includes('admin')) return true;
    
    return permissions.includes(perm);
  }, [permissions, userRoles]);
  
  const hasAnyPermission = useCallback((perms: string[]) => {
    return perms.some(p => hasPermission(p));
  }, [hasPermission]);
  
  const hasAllPermissions = useCallback((perms: string[]) => {
    return perms.every(p => hasPermission(p));
  }, [hasPermission]);
  
  return { 
    permissions, 
    hasPermission, 
    hasAnyPermission, 
    hasAllPermissions 
  };
}
```

3. **Component - Permission Guard**:
```typescript
// src/core/components/PermissionGuard.tsx
export function PermissionGuard({ 
  permission, 
  fallback, 
  children 
}: {
  permission: string | string[];
  fallback?: React.ReactNode;
  children: React.ReactNode;
}) {
  const { hasPermission, hasAnyPermission } = usePermissions();
  
  const allowed = Array.isArray(permission)
    ? hasAnyPermission(permission)
    : hasPermission(permission);
  
  if (!allowed) return fallback || null;
  return <>{children}</>;
}
```

4. **ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù€ RBAC Ø§Ù„Ø­Ø§Ù„ÙŠ**:
```typescript
// src/core/rbac/index.tsx - Update useCan
export function useCan() {
  const { hasPermission } = usePermissions();
  
  return useCallback((action: string, resource?: string) => {
    if (resource) {
      return hasPermission(`${resource}.${action}`);
    }
    return hasPermission(action);
  }, [hasPermission]);
}
```

**Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª:**
- âœ… Ù†Ø¸Ø§Ù… ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…Ø±Ù† ÙˆÙ‚Ø§Ø¨Ù„ Ù„Ù„ØªÙˆØ³Ø¹
- âœ… Ø¯Ø¹Ù… permissions Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ resource + action
- âœ… Ø³Ù‡ÙˆÙ„Ø© Ø¥Ø¶Ø§ÙØ© ØµÙ„Ø§Ø­ÙŠØ§Øª Ø¬Ø¯ÙŠØ¯Ø© Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©
- âœ… Performance optimization (caching)

---

#### **Part 1.4: Dynamic Sidebar (2 Ø³Ø§Ø¹Ø§Øª)** ğŸ¨

**Ø§Ù„Ù‡Ø¯Ù:** ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© Ù…Ù† static Ø¥Ù„Ù‰ dynamic Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ App Registry + Permissions

**Ø§Ù„Ø®Ø·ÙˆØ§Øª:**

1. **ØªØ­Ø¯ÙŠØ« `src/layouts/AppSidebar.tsx`**:
```typescript
import { useAppModules } from '@/core/hooks/useAppModules';
import { useAppFeatures } from '@/core/hooks/useAppFeatures';

export function AppSidebar() {
  const availableApps = useAppModules();
  const location = useLocation();
  
  // Detect current app from route
  const currentApp = availableApps.find(app => 
    location.pathname.startsWith(app.route)
  );
  
  const features = useAppFeatures(currentApp?.id || '');
  
  return (
    <aside>
      {/* App Switcher */}
      <div className="app-switcher">
        {availableApps.map(app => (
          <Link 
            key={app.id} 
            to={app.route}
            className={cn(
              "app-item",
              currentApp?.id === app.id && "active"
            )}
          >
            <app.icon />
            <span>{app.nameAr}</span>
            {app.status === 'beta' && <Badge>Beta</Badge>}
          </Link>
        ))}
      </div>
      
      {/* Current App Features */}
      {currentApp && (
        <nav className="app-navigation">
          <h3>{currentApp.nameAr}</h3>
          {features.map(feature => (
            <NavLink 
              key={feature.id}
              to={feature.route}
            >
              <feature.icon />
              {feature.name}
            </NavLink>
          ))}
        </nav>
      )}
    </aside>
  );
}
```

**Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª:**
- âœ… Ù‚Ø§Ø¦Ù…Ø© Ø¬Ø§Ù†Ø¨ÙŠØ© ØªØªØºÙŠØ± ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
- âœ… ØªØ¸Ù‡Ø± ÙÙ‚Ø· Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø³Ù…ÙˆØ­Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
- âœ… ØªØ¸Ù‡Ø± ÙÙ‚Ø· Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…Ø³Ù…ÙˆØ­Ø©
- âœ… Ø³Ù‡ÙˆÙ„Ø© Ø¥Ø¶Ø§ÙØ© ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© (ÙÙ‚Ø· ØªØ¹Ø¯ÙŠÙ„ App Registry)

---

#### **Part 1.5: Content Hub Full Implementation (9 Ø³Ø§Ø¹Ø§Øª)** ğŸ“š

**Ø§Ù„Ù‡Ø¯Ù:** ØªÙ†ÙÙŠØ° M4 Content Hub Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ (Ø­Ø§Ù„ÙŠØ§Ù‹ 25% ÙÙ‚Ø·)

**Ø§Ù„Ø®Ø·ÙˆØ§Øª:**

1. **Migration - Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯Ø§ÙˆÙ„ Content Hub** (1 Ø³Ø§Ø¹Ø©):
```sql
-- Main content items table
CREATE TABLE IF NOT EXISTS public.contents (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  tenant_id UUID NOT NULL REFERENCES public.tenants(id) ON DELETE CASCADE,
  
  -- Content type
  type TEXT NOT NULL CHECK (type IN (
    'video', 'article', 'quiz_template', 'micro_journey',
    'phishing_template', 'policy', 'evidence_pack'
  )),
  
  -- Metadata
  title TEXT NOT NULL,
  description TEXT,
  lang TEXT NOT NULL DEFAULT 'ar' CHECK (lang IN ('ar', 'en')),
  
  -- Classification
  level TEXT CHECK (level IN ('A', 'B', 'C')), -- Awareness levels
  role_scope TEXT CHECK (role_scope IN ('employee', 'manager', 'it')),
  topic TEXT, -- 'phishing', 'password', 'mfa', 'privacy', etc.
  tags TEXT[] DEFAULT '{}',
  
  -- Lifecycle
  status TEXT NOT NULL DEFAULT 'draft' CHECK (status IN (
    'draft', 'preview', 'scheduled', 'published', 'archived'
  )),
  scheduled_at TIMESTAMPTZ,
  published_at TIMESTAMPTZ,
  
  -- Versioning
  version INTEGER NOT NULL DEFAULT 1,
  
  -- Tracking
  created_by UUID REFERENCES auth.users(id),
  published_by UUID REFERENCES auth.users(id),
  created_at TIMESTAMPTZ DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now(),
  
  -- Indexes
  CONSTRAINT unique_content_per_tenant UNIQUE(tenant_id, title, lang, version)
);

-- Content assets (files, links, html, json)
CREATE TABLE IF NOT EXISTS public.content_assets (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  content_id UUID NOT NULL REFERENCES public.contents(id) ON DELETE CASCADE,
  
  asset_type TEXT NOT NULL CHECK (asset_type IN ('file', 'link', 'html', 'json')),
  uri_or_blob_ref TEXT NOT NULL, -- URL or storage path
  
  -- File metadata
  checksum TEXT,
  size_bytes BIGINT,
  mime_type TEXT,
  metadata_json JSONB DEFAULT '{}',
  
  created_at TIMESTAMPTZ DEFAULT now()
);

-- Quiz templates
CREATE TABLE IF NOT EXISTS public.quiz_templates (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  content_id UUID NOT NULL REFERENCES public.contents(id) ON DELETE CASCADE,
  
  pass_score_default INTEGER DEFAULT 70 CHECK (pass_score_default BETWEEN 0 AND 100),
  shuffle_questions BOOLEAN DEFAULT true,
  shuffle_choices BOOLEAN DEFAULT true,
  
  created_at TIMESTAMPTZ DEFAULT now()
);

-- Quiz questions
CREATE TABLE IF NOT EXISTS public.quiz_template_questions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  quiz_template_id UUID NOT NULL REFERENCES public.quiz_templates(id) ON DELETE CASCADE,
  
  order_num INTEGER NOT NULL,
  type TEXT NOT NULL CHECK (type IN ('mcq', 'tf')), -- Multiple choice or True/False
  text TEXT NOT NULL,
  
  -- For MCQ: ["A) Option 1", "B) Option 2", "C) Option 3"]
  -- For TF: ["ØµØ­ÙŠØ­", "Ø®Ø·Ø£"]
  choices_json JSONB NOT NULL,
  
  -- Correct answer key (e.g., "A", "ØµØ­ÙŠØ­")
  correct_key TEXT NOT NULL,
  
  created_at TIMESTAMPTZ DEFAULT now(),
  
  CONSTRAINT unique_question_order UNIQUE(quiz_template_id, order_num)
);

-- Micro journeys
CREATE TABLE IF NOT EXISTS public.micro_journeys (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  content_id UUID NOT NULL REFERENCES public.contents(id) ON DELETE CASCADE,
  
  steps_json JSONB NOT NULL DEFAULT '[]', -- Array of step objects
  est_minutes INTEGER,
  
  created_at TIMESTAMPTZ DEFAULT now()
);

-- Evidence packs
CREATE TABLE IF NOT EXISTS public.evidence_packs (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  content_id UUID NOT NULL REFERENCES public.contents(id) ON DELETE CASCADE,
  
  manifest_json JSONB NOT NULL DEFAULT '{}', -- Pack metadata + file list
  built_at TIMESTAMPTZ,
  
  created_at TIMESTAMPTZ DEFAULT now()
);

-- Content audit log
CREATE TABLE IF NOT EXISTS public.content_audit_log (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  content_id UUID NOT NULL REFERENCES public.contents(id) ON DELETE CASCADE,
  
  actor_user_id UUID NOT NULL REFERENCES auth.users(id),
  action TEXT NOT NULL CHECK (action IN (
    'create', 'update', 'preview', 'schedule', 'publish', 'archive'
  )),
  
  diff_json JSONB,
  ts TIMESTAMPTZ DEFAULT now()
);

-- RLS Policies
ALTER TABLE public.contents ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.content_assets ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.quiz_templates ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.quiz_template_questions ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.micro_journeys ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.evidence_packs ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.content_audit_log ENABLE ROW LEVEL SECURITY;

-- Policies (same pattern for all)
CREATE POLICY "Users can view content in their tenant"
  ON public.contents FOR SELECT
  USING (tenant_id = get_user_tenant_id(auth.uid()));

CREATE POLICY "Content managers can create content"
  ON public.contents FOR INSERT
  WITH CHECK (
    tenant_id = get_user_tenant_id(auth.uid()) 
    AND created_by = auth.uid()
  );

CREATE POLICY "Content managers can update content"
  ON public.contents FOR UPDATE
  USING (tenant_id = get_user_tenant_id(auth.uid()));

-- ... similar policies for other tables
```

2. **Integration Layer** (2 Ø³Ø§Ø¹Ø§Øª):
```typescript
// src/modules/content-hub/integration.ts
export const contentHubIntegration = {
  // List content items
  async listContents(filters: ContentFilters) {
    return supabase
      .from('contents')
      .select('*, content_assets(*)')
      .match(filters)
      .order('created_at', { ascending: false });
  },
  
  // Create content
  async createContent(data: CreateContentDto) {
    return supabase.from('contents').insert(data).select().single();
  },
  
  // Publish content
  async publishContent(contentId: string) {
    return supabase
      .from('contents')
      .update({ 
        status: 'published', 
        published_at: new Date().toISOString() 
      })
      .eq('id', contentId);
  },
  
  // Quiz template operations
  async createQuizTemplate(contentId: string, data: QuizTemplateDto) {
    // Insert template + questions in transaction
  },
  
  // Evidence pack operations
  async buildEvidencePack(contentIds: string[]) {
    // Build manifest + collect assets
  },
};
```

3. **UI Components** (4 Ø³Ø§Ø¹Ø§Øª):
   - Content List Page
   - Content Creator Wizard
   - Quiz Builder Component
   - Content Preview Modal
   - Evidence Pack Builder

4. **Hooks** (2 Ø³Ø§Ø¹Ø§Øª):
   - `useContentList()`
   - `useCreateContent()`
   - `usePublishContent()`
   - `useQuizBuilder()`
   - `useEvidencePack()`

**Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª:**
- âœ… Content Hub ÙƒØ§Ù…Ù„ 100%
- âœ… Ø¯Ø¹Ù… Ø¬Ù…ÙŠØ¹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
- âœ… Ù†Ø¸Ø§Ù… Quiz Builder Ù…ØªÙƒØ§Ù…Ù„
- âœ… Evidence Packs Ø¬Ø§Ù‡Ø²
- âœ… Audit trail ÙƒØ§Ù…Ù„

---

### Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1

| Part | Time | Status | Priority |
|------|------|--------|----------|
| 1.1 Code Restructuring | 4h | Critical | ğŸ”´ P0 |
| 1.2 App Registry | 3h | Critical | ğŸ”´ P0 |
| 1.3 Permission System | 6h | Critical | ğŸ”´ P0 |
| 1.4 Dynamic Sidebar | 2h | High | ğŸŸ¡ P1 |
| 1.5 Content Hub | 9h | High | ğŸŸ¡ P1 |
| **Total** | **24h** | â€” | â€” |

**Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1ØŒ Ø³ÙŠÙƒÙˆÙ† Ø§Ù„Ù†Ø¸Ø§Ù…:**
- âœ… Ù…Ù†ØµØ© Ø­Ù‚ÙŠÙ‚ÙŠØ© ÙˆÙ„ÙŠØ³ ØªØ·Ø¨ÙŠÙ‚ ÙˆØ§Ø­Ø¯
- âœ… Ø¬Ø§Ù‡Ø² Ù„Ø¥Ø¶Ø§ÙØ© ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© Ø®Ù„Ø§Ù„ Ø³Ø§Ø¹Ø§Øª
- âœ… Ù†Ø¸Ø§Ù… ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…Ø±Ù† ÙˆÙ‚ÙˆÙŠ
- âœ… Content Hub ÙƒØ§Ù…Ù„ ÙˆÙ…ØªÙƒØ§Ù…Ù„

---

## Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2: ØªÙˆØ³ÙŠØ¹ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª (Expansion) â€” 40 Ø³Ø§Ø¹Ø©

### Part 2.1: LMS Full Implementation (16 Ø³Ø§Ø¹Ø§Øª)
- Migration: `courses`, `lessons`, `enrollments`, `assignments`, `submissions`
- UI: Course Builder, Student Portal, Instructor Dashboard
- Integration: With Content Hub, Progress Tracking

### Part 2.2: Phishing Simulator (12 Ø³Ø§Ø¹Ø§Øª)
- Migration: `phishing_campaigns`, `phishing_scenarios`, `phishing_results`
- UI: Scenario Builder, Campaign Manager, Analytics
- Integration: Email sending, Landing pages, Tracking

### Part 2.3: GRC Enhancement (12 Ø³Ø§Ø¹Ø§Øª)
- Migration: `frameworks`, `controls`, `assessments`, `risks`
- UI: Risk Matrix, Control Testing, Compliance Dashboard
- Integration: With Incidents (M13), Audit (M10)

---

## Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3: Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© (Optimization) â€” 20 Ø³Ø§Ø¹Ø©

### Part 3.1: Event System (4 Ø³Ø§Ø¹Ø§Øª)
```typescript
// src/core/events/AppEventBus.ts
class AppEventBus {
  emit(event: AppEvent) { /* ... */ }
  on(eventType: string, handler: Function) { /* ... */ }
}

// Events:
// - CAMPAIGN_COMPLETED
// - QUIZ_PASSED / QUIZ_FAILED
// - COURSE_COMPLETED
// - PHISHING_CLICKED
// - RISK_ESCALATED
```

### Part 3.2: AI Advisory Integration (8 Ø³Ø§Ø¹Ø§Øª)
- Recommendations Engine
- Risk Predictions
- Content Suggestions

### Part 3.3: Performance Optimization (4 Ø³Ø§Ø¹Ø§Øª)
- Query optimization
- Caching strategies
- CDN integration

### Part 3.4: Advanced Reporting (4 Ø³Ø§Ø¹Ø§Øª)
- Cross-app analytics
- Executive dashboards
- Export capabilities

---

## ğŸ¯ Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù†Ø¬Ø§Ø­ Success Criteria

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1 (Foundation)
- [x] Ø¨Ù†ÙŠØ© Ø§Ù„ÙƒÙˆØ¯ Ù…Ù†Ø¸Ù…Ø© (core/modules/apps)
- [x] Ù†Ø¸Ø§Ù… App Registry Ø¹Ø§Ù…Ù„ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
- [x] ØµÙ„Ø§Ø­ÙŠØ§Øª ØªÙØµÙŠÙ„ÙŠØ© ØªØ¹Ù…Ù„
- [x] Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©
- [x] Content Hub Ù…ÙƒØªÙ…Ù„ 100%
- [x] Ø¥Ø¶Ø§ÙØ© ØªØ·Ø¨ÙŠÙ‚ Ø¬Ø¯ÙŠØ¯ ØªØ³ØªØºØ±Ù‚ < 4 Ø³Ø§Ø¹Ø§Øª

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2 (Expansion)
- [ ] 3 ØªØ·Ø¨ÙŠÙ‚Ø§Øª ØªØ¹Ù…Ù„ Ø¨ÙƒØ§Ù…Ù„ Ø·Ø§Ù‚ØªÙ‡Ø§ (Awareness, LMS, Phishing)
- [ ] Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§Ø­Ø¯ ÙŠÙ…ÙƒÙ†Ù‡ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ø¹Ø¯Ø© ØªØ·Ø¨ÙŠÙ‚Ø§Øª
- [ ] Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø´ØªØ±ÙƒØ© Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ (Users, Tenants, Reports)
- [ ] Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙƒØ±Ø§Ø± ÙÙŠ Ø§Ù„ÙƒÙˆØ¯

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3 (Optimization)
- [ ] Event system ÙŠØ¹Ù…Ù„ Ø¨ÙŠÙ† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª
- [ ] Performance: p95 < 300ms
- [ ] AI recommendations ØªØ¹Ù…Ù„
- [ ] Cross-app reporting Ø¬Ø§Ù‡Ø²

---

## âš ï¸ Ø§Ù„Ù…Ø®Ø§Ø·Ø± ÙˆØ§Ù„ØªØ­Ø¯ÙŠØ§Øª Risks & Challenges

| Risk | Impact | Mitigation |
|------|--------|------------|
| Breaking existing features | ğŸ”´ High | Comprehensive testing before deployment |
| Import paths confusion | ğŸŸ¡ Medium | Use barrel exports + clear naming |
| Permission system complexity | ğŸŸ¡ Medium | Start simple, iterate based on feedback |
| Content Hub migration data loss | ğŸ”´ High | Full backup before migration |
| Performance degradation | ğŸŸ¡ Medium | Load testing + monitoring |

---

## ğŸ“¦ Deliverables Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª

### Documentation
- [x] Ø®Ø·Ø© Ø§Ù„ØªÙˆØ³Ø¹ (Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù)
- [ ] Architecture Guide (Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1)
- [ ] App Development Guide (ÙƒÙŠÙ ØªØ¶ÙŠÙ ØªØ·Ø¨ÙŠÙ‚ Ø¬Ø¯ÙŠØ¯)
- [ ] Permission Management Guide
- [ ] Migration Scripts Documentation

### Code
- [ ] Restructured codebase (core/modules/apps)
- [ ] App Registry system
- [ ] Enhanced Permission system
- [ ] Dynamic Sidebar
- [ ] Full Content Hub implementation
- [ ] 100% test coverage for core layer

### Database
- [ ] `role_permissions` table
- [ ] Content Hub tables (7 tables)
- [ ] Seed data for permissions
- [ ] Migration scripts

---

## ğŸš¦ Go/No-Go Decision Points

### Ù‚Ø¨Ù„ Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1
- [ ] Ù…ÙˆØ§ÙÙ‚Ø© ØµØ§Ø­Ø¨ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
- [ ] Backup ÙƒØ§Ù…Ù„ Ù„Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
- [ ] Environment ØªØ¬Ø±ÙŠØ¨ÙŠ Ø¬Ø§Ù‡Ø²
- [ ] ÙØ±ÙŠÙ‚ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ø§Ù‡Ø²

### Ù‚Ø¨Ù„ Deployment Ù„Ù„Ø¥Ù†ØªØ§Ø¬
- [ ] Ø¬Ù…ÙŠØ¹ Tests ØªØ¹Ù…Ù„ Ø¨Ù†Ø¬Ø§Ø­
- [ ] Load testing passed
- [ ] Security audit passed
- [ ] Documentation Ù…ÙƒØªÙ…Ù„Ø©
- [ ] Training Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù…ÙƒØªÙ…Ù„

---

## ğŸ“Š Timeline Summary

| Phase | Duration | End Date (Estimated) |
|-------|----------|----------------------|
| Phase 1: Foundation | 24 hours | Week 1 |
| Phase 2: Expansion | 40 hours | Week 3 |
| Phase 3: Optimization | 20 hours | Week 4 |
| **Total** | **84 hours** | **~1 month** |

*Note: Timeline assumes single developer, full-time work. Adjust for team size.*

---

## âœ… Next Steps

**Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ÙÙˆØ±ÙŠØ©:**

1. **Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø®Ø·Ø©** Ù…Ø¹ ØµØ§Ø­Ø¨ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
2. **Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©** Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1
3. **Ø¥Ù†Ø´Ø§Ø¡ branch Ø¬Ø¯ÙŠØ¯**: `feature/platform-foundation`
4. **Backup** ÙƒØ§Ù…Ù„ Ù„Ù„Ù†Ø¸Ø§Ù…
5. **Ø§Ù„Ø¨Ø¯Ø¡** ÙÙŠ Part 1.1: Code Restructuring

---

## ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Notes

- Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø© Ù…Ø¨Ù†ÙŠØ© Ø¹Ù„Ù‰ ØªØ­Ù„ÙŠÙ„ Ø¯Ù‚ÙŠÙ‚ Ù„Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯
- ØªÙ… Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Content Hub ÙÙŠ Ø§Ù„ØªÙˆØ«ÙŠÙ‚ (100%) ÙˆØ§Ù„ØªÙ†ÙÙŠØ° (25%)
- Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„ÙˆØ§Ø±Ø¯Ø© Ø£Ø¹Ù„Ø§Ù‡ Ø¯Ù‚ÙŠÙ‚Ø© ÙˆÙ…Ø¨Ù†ÙŠØ© Ø¹Ù„Ù‰ ÙØ­Øµ ÙØ¹Ù„ÙŠ Ù„Ù„ÙƒÙˆØ¯
- ÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ø§Ù„Ø¹Ù…Ù„
- Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ‚Ø¯ÙŠØ±Ø§Øª Ø§Ù„Ø²Ù…Ù†ÙŠØ© ØªÙØªØ±Ø¶ Ù…Ø·ÙˆØ± ÙˆØ§Ø­Ø¯ Ù…ØªÙØ±Øº

---

**Ø§Ù„Ø¥ØµØ¯Ø§Ø±:** v1.0  
**Ø§Ù„ØªØ§Ø±ÙŠØ®:** 2025-11-14  
**Ø§Ù„Ø­Ø§Ù„Ø©:** Ù…Ø³ÙˆØ¯Ø© Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©  
**Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©:** Ù…Ø¹Ù„Ù‚Ø©

---

*"Ø§Ù„Ù†Ø¬Ø§Ø­ ÙÙŠ Ø¨Ù†Ø§Ø¡ Ù…Ù†ØµØ© Ù„Ø§ ÙŠÙƒÙˆÙ† Ø¨Ø­Ø¬Ù… Ø§Ù„ÙƒÙˆØ¯ØŒ Ø¨Ù„ Ø¨ÙˆØ¶ÙˆØ­ Ø§Ù„Ø¨Ù†ÙŠØ©"*
